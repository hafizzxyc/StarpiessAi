<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üåü StarpiesAi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body { margin:0; font-family: Arial, sans-serif; background:#f5f5f5; }
    header { background:#202123; color:white; padding:10px; display:flex; justify-content:space-between; align-items:center; }
    header h1 { margin:0; font-size:18px; }
    .menu { cursor:pointer; font-size:20px; }
    .profile { width:32px; height:32px; border-radius:50%; background:#4CAF50; display:flex; align-items:center; justify-content:center; color:white; cursor:pointer; }

    .chat-container { max-width:800px; margin:auto; padding:10px; }
    .chat-box { background:white; padding:20px; border-radius:10px; min-height:400px; box-shadow:0 2px 6px rgba(0,0,0,0.1); overflow-y:auto; }
    .message { padding:10px; border-radius:8px; margin-bottom:10px; max-width:80%; animation:fadeIn 0.3s ease-in-out; }
    .user { background:#007bff; color:white; margin-left:auto; }
    .bot { background:#e5e5ea; color:black; margin-right:auto; }
    @keyframes fadeIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }

    .input-box { display:flex; margin-top:10px; }
    .input-box input { flex:1; padding:10px; border-radius:8px; border:1px solid #ccc; }
    .input-box button { padding:10px 15px; margin-left:10px; border:none; border-radius:8px; background:#28a745; color:white; cursor:pointer; }

    /* Sidebar menu */
    .sidebar { position:fixed; top:0; left:-250px; width:250px; height:100%; background:#333; color:white; padding:20px; transition:0.3s; }
    .sidebar.active { left:0; }
    .sidebar a { display:block; padding:10px 0; color:white; text-decoration:none; border-bottom:1px solid #555; }
    .sidebar a:hover { background:#444; }

    /* Modal login/register */
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center; }
    .modal-content { background:white; padding:20px; border-radius:10px; width:300px; }
    .modal-content h2 { margin-top:0; }
    .modal-content input { width:100%; padding:8px; margin:5px 0; }
    .modal-content button { width:100%; padding:10px; background:#007bff; color:white; border:none; border-radius:5px; cursor:pointer; }
</style>
</head>
<body>

<header>
    <div class="menu" onclick="toggleSidebar()">‚ò∞</div>
    <h1>üåü StarpiesAi</h1>
    <div class="profile" onclick="openLogin()">üë§</div>
</header>

<div class="sidebar" id="sidebar">
    <a href="#" onclick="resetChat()">üîÑ Reset Chat</a>
    <a href="https://tiktok.com/hafizzxyc" target="_blank">üéµ TikTok Developer</a>
    <a href="https://t.me/@syredstricks" target="_blank">üí¨ Telegram Developer</a>
    <a href="#" onclick="logout()">üö™ Logout</a>
</div>

<div class="chat-container">
    <div class="chat-box" id="chatBox"></div>
    <div class="input-box">
        <input type="text" id="userInput" placeholder="Ketik pesan..." />
        <button onclick="sendMessage()">Kirim</button>
    </div>
</div>

<!-- Modal Login -->
<div class="modal" id="loginModal">
    <div class="modal-content">
        <h2>Login</h2>
        <input type="text" id="loginUser" placeholder="Username">
        <input type="password" id="loginPass" placeholder="Password">
        <button onclick="login()">Login</button>
        <p>Belum punya akun? <a href="#" onclick="openRegister()">Register</a></p>
    </div>
</div>

<!-- Modal Register -->
<div class="modal" id="registerModal">
    <div class="modal-content">
        <h2>Register</h2>
        <input type="text" id="regUser" placeholder="Username">
        <input type="password" id="regPass" placeholder="Password">
        <button onclick="register()">Register</button>
        <p>Sudah punya akun? <a href="#" onclick="openLogin()">Login</a></p>
    </div>
</div>

<script>
let currentUser = localStorage.getItem("currentUser") || null;

function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("active");
}

function openLogin() {
    if (currentUser) {
        alert("Sudah login sebagai " + currentUser);
    } else {
        document.getElementById("loginModal").style.display = "flex";
    }
}

function openRegister() {
    document.getElementById("loginModal").style.display = "none";
    document.getElementById("registerModal").style.display = "flex";
}

function closeModals() {
    document.getElementById("loginModal").style.display = "none";
    document.getElementById("registerModal").style.display = "none";
}

function register() {
    let user = document.getElementById("regUser").value.trim();
    let pass = document.getElementById("regPass").value.trim();
    if (!user || !pass) return alert("Isi semua data!");
    if (localStorage.getItem("user_"+user)) return alert("Username sudah terdaftar!");
    localStorage.setItem("user_"+user, pass);
    alert("Registrasi berhasil! Silakan login.");
    closeModals();
}

function login() {
    let user = document.getElementById("loginUser").value.trim();
    let pass = document.getElementById("loginPass").value.trim();
    let storedPass = localStorage.getItem("user_"+user);
    if (!storedPass) return alert("User tidak ditemukan!");
    if (storedPass !== pass) return alert("Password salah!");
    currentUser = user;
    localStorage.setItem("currentUser", user);
    alert("Login berhasil!");
    closeModals();
}

function logout() {
    localStorage.removeItem("currentUser");
    currentUser = null;
    alert("Logout berhasil!");
}

async function sendMessage() {
    if (!currentUser) return alert("Login dulu untuk chat!");
    const input = document.getElementById('userInput');
    const text = input.value.trim();
    if (!text) return;

    addMessage(text, 'user');
    input.value = '';

    try {
        const url = `https://api.sxtream.xyz/ai/megpt?query=${encodeURIComponent(text)}`;
        const res = await fetch(url);
        const data = await res.json();
        if (data?.data) {
            addMessage(data.data, 'bot');
        } else {
            addMessage('‚ùå Tidak ada respon dari AI', 'bot');
        }
    } catch (err) {
        addMessage('‚ö†Ô∏è Gagal fetch API', 'bot');
    }
}

function addMessage(text, sender) {
    const chatBox = document.getElementById('chatBox');
    const msg = document.createElement('div');
    msg.className = `message ${sender}`;
    msg.innerText = text;
    chatBox.appendChild(msg);
    chatBox.scrollTop = chatBox.scrollHeight;
}

function resetChat() {
    document.getElementById('chatBox').innerHTML = '';
}
</script>
</body>
</html>
